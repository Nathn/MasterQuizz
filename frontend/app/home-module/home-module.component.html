<div class="qdjlogo">
    {{ moduleTitle }}
</div>
<div
    *ngIf="moduleType == 'question' && question"
    class="module-content-container"
>
    <app-question
        [question]="question"
        [answerValidated]="answerValidated"
        [selectedAnswerIndex]="selectedAnswerIndex"
        (selectedAnswer)="selectAnswer($event)"
    ></app-question>
    <div>
        <button
            class="button-start transparent"
            *ngIf="answerValidated"
            (click)="next()"
        >
            Une autre !
        </button>
        <button
            class="button-start transparent"
            *ngIf="!answerValidated"
            (click)="validateAnswer()"
            [disabled]="selectedAnswerIndex == -1"
        >
            Valider
        </button>
    </div>
</div>
<div
    *ngIf="moduleType == 'match' && question && !moduleParams.matchEnded"
    class="module-content-container"
>
    <app-question
        [question]="question"
        [answerValidated]="answerValidated"
        [questionOptions]="{ hideAnswers: moduleParams.hideAnswers }"
        (selectedAnswer)="selectAnswer($event)"
        [selectedAnswerIndex]="selectedAnswerIndex"
    ></app-question>
    <div>
        <button
            class="button-start"
            *ngIf="answerValidated && !moduleParams.nextQuestionReady"
            disabled
        >
            <fa-icon [icon]="['fas', 'spinner']" [spin]="true"></fa-icon>
            En attente de l'adversaire...
        </button>
        <button
            class="button-start"
            *ngIf="answerValidated && moduleParams.nextQuestionReady"
            (click)="next()"
        >
            Question suivante
        </button>
        <button
            class="button-start"
            *ngIf="!answerValidated"
            (click)="validateAnswer()"
            [disabled]="selectedAnswerIndex == -1"
        >
            Valider
        </button>
    </div>
</div>
<div
    *ngIf="moduleType == 'match' && moduleParams.matchEnded"
    class="module-content-container"
>
    <div class="results">
        Match termin√©
        <br /><br />
        <span *ngIf="moduleParams.matchObj.winner"
            >Vainqueur :
            {{
                moduleParams.matchObj.winner.displayName ||
                    moduleParams.matchObj.winner.username
            }}</span
        >
        <span *ngIf="!moduleParams.matchObj.winner">Match nul</span>
        <br /><br />
        Scores :
        <br />
        {{
            moduleParams.matchObj.users[0].displayName ||
                moduleParams.matchObj.users[0].username
        }}
        :
        {{ moduleParams.scores[moduleParams.matchObj.users[0]._id] }}/10
        <br />
        {{
            moduleParams.matchObj.users[1].displayName ||
                moduleParams.matchObj.users[1].username
        }}
        :
        {{ moduleParams.scores[moduleParams.matchObj.users[1]._id] }}/10
        <br /><br />
        <span *ngIf="moduleParams.eloChange">
            {{ moduleParams.eloChange > 0 ? "+" : ""
            }}{{ moduleParams.eloChange }}&nbsp;üèÜ
        </span>
    </div>
    <div>
        <button class="button-start" (click)="next()">Quitter le match</button>
    </div>
</div>
<div
    *ngIf="moduleType == 'ranking' && ranking && ranking.length > 0"
    class="module-content-container not-centered"
    style="width: 90%"
>
    <ul class="rankingmodule-slide-ranking">
        <a
            *ngFor="let user of ranking; let i = index"
            href="/profile/{{ user.username }}"
            [ngClass]="{
                'rankingmodule-is-current-user': user._id == moduleParams.userId
            }"
        >
            <div class="rankingmodule-slide-ranking-position">{{ i + 1 }}</div>
            <div class="rankingmodule-slide-ranking-user-info">
                <img
                    [src]="user.avatarUrl"
                    class="rankingmodule-slide-ranking-avatar"
                    alt="Avatar"
                    height="26"
                    width="26"
                />
                <div class="rankingmodule-slide-ranking-name">
                    {{ user.displayName }}
                </div>
            </div>
            <div
                class="rankingmodule-slide-ranking-score"
                *ngIf="moduleParams.rankBy == 'elo'"
            >
                {{ user.elo }}&nbsp;üèÜ
            </div>
            <div
                class="rankingmodule-slide-ranking-score"
                *ngIf="moduleParams.rankBy == 'nbGames' && user.stats"
            >
                {{
                    user.stats.duels.wins +
                        user.stats.duels.losses +
                        user.stats.duels.draws
                }}
            </div>
            <div
                class="rankingmodule-slide-ranking-score"
                *ngIf="moduleParams.rankBy == 'nbWins' && user.stats"
            >
                {{ user.stats.duels.wins }}
            </div>
            <div
                class="rankingmodule-slide-ranking-score"
                *ngIf="moduleParams.rankBy == 'nbGoodAnswers' && user.stats"
            >
                {{ user.stats.questions.right }}
            </div>
        </a>
    </ul>
</div>
<div
    *ngIf="
        ((moduleType == 'question' || moduleType == 'match') && !question) ||
        (moduleType == 'ranking' && (!ranking || ranking.length == 0))
    "
    class="module-content-container spinner"
>
    <fa-icon [icon]="['fas', 'spinner']" [spin]="true"></fa-icon>
</div>
